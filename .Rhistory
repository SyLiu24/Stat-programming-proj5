norm(1)
norm(c(1))
?norm
norm(matrix(1))
?as.matrix
norm(as.matrix(1))
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(-11,rb1,gb1,hb1)
diag(as.matrix(1))
diag(1)
diag(1)=diag(1)+1
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(-11,rb1,gb1,hb1)
chol(1)
chol(-1)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(-11,rb1,gb1,hb1)
newt(-11,rb2,gb2,hb2)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(-11,rb2,gb2,hb2)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(0,rb2,gb2,hb2)
newt(1,rb2,gb2,hb2)
newt(-1,rb2,gb2,hb2)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(-1,rb2,gb2,hb2)
?sprintf
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
a(1)
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
a(1)
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
a(1)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(0,rb2,gb2,hb2)
?log
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(0,rb2,gb2,hb2)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(0,rb2,gb2,hb2)
newt(1,rb2,gb2,hb2)
newt(1,rb2,gb2,hb2)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(1,rb2,gb2,hb2)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(1,rb2,gb2,hb2)
log(-1)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(1,rb2,gb2,hb2)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(3,rb2,gb2,hb2)
newt(3,rb2,gb2)
newt(3,rb1,gb1)
?dpois
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
nll(c(1,1),1,2)
2*(log(1)+1)-exp(1)-log(2)
?log
lg(1)
log(1)
log(exp(1))
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
fit
newt(c(10,.1),nll,gll,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240))
newt(c(10,.1),nll,gll,hess=NULL,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240))
newt(theta=c(10,.1),nll,gll,hess=NULL,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240))
newt(theta=c(10,.1),nll,gll,hess=NULL,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=200)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(theta=c(10,.1),nll,gll,hess=NULL,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=200)
newt(theta=c(10,.1),nll,gll,hess=NULL,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
fit
newt(theta=c(10,.1),nll,gll,hess=NULL,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000)
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
newt(theta=c(10,.1),nll,gll,hess=NULL,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000)
newt(theta=c(20,.1),nll,gll,hess=NULL,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000)
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
newt(theta=c(20,.1),nll,gll,hll,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000)
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
source("D:/Edinburgh/Statistical Programming/proj4/UntitledR.R")
nlm(nll2,th0,y=y,t=t)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(theta=c(20,.1),nll,gll,hll,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000)
newt(theta=c(10,.1),nll,gll,hll,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000)
newt(theta=c(10,.1),nll,gll,hess=NULL,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000,eps=1e-7)
newt(c(10,.1),nll,gll,hess=NULL,t=1:13,y=c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000,eps=1e-7)
newt(c(10,.1),nll,gll,hess=NULL,1:13,c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000,eps=1e-7)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(c(10,.1),nll,gll,hess=NULL,1:13,c(12,14,33,50,67,74,123,141,165,204,253,246,240),maxit=1000,eps=1e-7)
system.time(newt(c(10,.1),nll,gll,hess=NULL,1:13,c(12,14,33,50,67,74,123,141,165,204,253,246,240)))
system.time(newt(c(10,.1),nll,gll,hess=NULL,1:13,c(12,14,33,50,67,74,123,141,165,204,253,246,240)))
system.time(newt(c(10,.1),nll,gll,hess=NULL,1:13,c(12,14,33,50,67,74,123,141,165,204,253,246,240)))
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
source("D:/Edinburgh/Statistical Programming/proj4/test.R")
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
source("D:/Edinburgh/Statistical Programming/proj4/test.R")
source("D:/Edinburgh/Statistical Programming/proj4/test.R")
source("D:/Edinburgh/Statistical Programming/proj4/test.R")
source("D:/Edinburgh/Statistical Programming/proj4/test.R")
newt(c(10,.1),nll,gll,hess=NULL,t,y)
fit
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
newt(c(10,.1),nll,gll,hess=NULL,t,y)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
source("D:/Edinburgh/Statistical Programming/proj4/test.R")
source("D:/Edinburgh/Statistical Programming/proj4/test.R", echo=TRUE)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R", echo=TRUE)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R", echo=TRUE)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R")
source("D:/Edinburgh/Statistical Programming/proj4/test.R", echo=TRUE)
source("D:/Edinburgh/Statistical Programming/proj4/proj4.R", echo=TRUE)
source("D:/Edinburgh/Statistical Programming/proj4/test.R", echo=TRUE)
source("D:/Edinburgh/Statistical Programming/hw4/proj4 (1).R", echo=TRUE)
source("D:/Edinburgh/Statistical Programming/proj4/test.R", echo=TRUE)
newt(c(0,0),rb,gb)
newt(c(1,1),rb,gb)
newt(c(1,1),rb,gb,hb)
source("D:/Edinburgh/Statistical Programming/proj5/proj5.R", echo=TRUE)
source("D:/Edinburgh/Statistical Programming/proj5/proj5.R", echo=TRUE)
lt <- read.table("lt1720uk.datt",header=TRUE)
lt <- read.table("lt1720uk.dat",header=TRUE)
lt
lt$age
lt$age[1]
lt[1,1]
lt <- read.table("lt1720uk.dat",header=TRUE)
death <- read.table("death1722uk.dat",header=TRUE)
death
m<-lt$mm
m
1-exp(-m/52)
a=c(1,2,3)
a
c(1,a)
a
c(0,a[-3])
a<-matrix(1:6,2,3)
a
b=c(0,0)
b=c(8,9)
c(b,a)
cbind(b,a)
c=cbind(b,a)
c
c[,-4]
rep(0,2)
a
sum(a)
source("D:/Edinburgh/Statistical Programming/proj5/proj5.R", echo=TRUE)
source("D:/Edinburgh/Statistical Programming/proj5/proj5.R")
death
d1=death$deaths[:156]
d1=death$deaths[1:156]
d1
d2=predict_death(lt$fpop17,lt$mpop17,lt$mf,lt$mm,death$d[1:156])
d2
d2-d1
source("D:/Edinburgh/Statistical Programming/proj5/proj5.R")
d2-d1
source("D:/Edinburgh/Statistical Programming/proj5/proj5.R")
d2-d1
death$week
a
nrow(a)
w22 <- nrow(death)
ed2022 <- sum(death$deaths[157:w22] -
predict_death(lt$fpop20,lt$mpop20,lt$mf,lt$mm,death$d[157:w22]))
ed20 <- sum(death$deaths[157:209] -
predict_death(lt$fpop20,lt$mpop20,lt$mf,lt$mm,death$d[157:209]))
ed2022
ed20
ob_death20 <- death$deaths[157:209]
pre_death20 <- predict_death(lt$fpop20,lt$mpop20,lt$mf,lt$mm,death$d[157:209])
ed20 <- sum(ob_death20 - pre_death20)
plot(157:209,ob_death20)
source("D:/Edinburgh/Statistical Programming/proj3/proj3.R")
plot(157:209,ob_death20)
lines(157:209,pre_death20)
w22 <- nrow(death)
ob_death2022 <- death$deaths[157:w22]
pre_death2022 <- predict_death(lt$fpop20,lt$mpop20,lt$mf,lt$mm,death$d[157:w22])
ed2022 <- sum(ob_death2022 - pre_death2022)
ob_death20 <- death$deaths[157:209]
pre_death20 <- predict_death(lt$fpop20,lt$mpop20,lt$mf,lt$mm,death$d[157:209])
ed20 <- sum(ob_death20 - pre_death20)
plot(157:w22,ob_death2022)
lines(157:w22,pre_death2022)
?cumsum
ed2022_w <- ob_death2022 - pre_death2022
plot(157:w22,cumsum(ed2022_w))
cumsum(c(1,2,3))
ed2022_w
library(rjags)
?dexp
?dunif
library(rjags)
mod <- jags.model("model.jags",data=list(x=ed2022_w,N=w22-157+1))
a=1:9
a
a[c(1,3,5)]<-NA
a
x <- ed2022_w
x[c(51,52,53,105,106)] <- NA
mod <- jags.model("model.jags",data=list(x=x,N=w22-157+1))
sam.coda <- coda.samples(mod,c("mu","rho","k"),n.iter=10000)
str(sam.coda)
x <- ed2022_w
x[c(51,52,53,105,106)] <- NA
mod <- jags.model("model.jags",data=list(x=x,N=w22-157+1))
sam.coda <- coda.samples(mod,c("mu","rho","k"),n.iter=10000)
str(sam.coda)
x
mod <- jags.model("model.jags",data=list(x=x,N=w22-157+1))
sam <- jags.samples(mod,c("mu","rho","k"),n.iter=10000)
str(sam)
mod <- jags.model("model.jags",data=list(x=x,N=w22-157+1))
# sam <- jags.samples(mod,c("mu","rho","k"),n.iter=10000)
# str(sam)
sam.coda <- coda.samples(mod,c("mu","rho","k"),n.iter=10000)
str(sam.coda)
plot(sam.coda$rho)
plot(sam.coda[2])
plot(sam.coda[,2])
sam.coda
sam.coda[,2]
sam.coda[,'rho']
plot(sam.coda[,"rho"])
mod <- jags.model("model.jags",data=list(x=x,N=w22-157+1))
sam <- jags.samples(mod,c("mu","rho","k"),n.iter=10000)
str(sam)
ram
sam
sam$k
str(sam)
attr(sam$k,'iterations')
sam$k$iterations
sam$k$'iterations'
sam$k
sam$k[2]
sam$k[2]
sam$k[3]
sam$k[1,,]
sam.coda
sam.coda[,'rho']
str(sam.coda)
sam.coda$'rho'
sam.coda$$'rho'
?str
str(sam)
sam$k[,,,]
sam$k[1,,,]
sam$k[,,]
sam.coda[[1]][,'rho']
mod <- jags.model("model.jags",data=list(x=ed2022_w,N=w22-157+1))
mod <- jags.model("model.jags",data=list(x=ed2022_w,N=w22-157+1))
x
x[c(51,52,53,105,106)] <- NA
mod <- jags.model("model.jags",data=list(x=ed2022_w,N=w22-157+1))
mod <- jags.model("model.jags",data=list(x=ed2022_w,N=w22-157+1))
mod <- jags.model("model.jags",data=list(y=ed2022_w,N=w22-157+1))
mod <- jags.model("model.jags",data=list(y=ed2022_w,N=w22-157+1))
mod <- jags.model("model.jags",data=list(y=ed2022_w,N=w22-157+1))
sam <- jags.samples(mod,c("mu","rho","k"),n.iter=10000)
mod <- jags.model("model.jags",data=list(y=ed2022_w,N=w22-157+1))
mod <- jags.model("model.jags",data=list(y=ed2022_w,N=w22-157+1))
x <- ed2022_w
x[c(51,52,53,105,106)] <- NA
mod <- jags.model("model.jags",data=list(x=x,N=w22-157+1))
# sam <- jags.samples(mod,c("mu","rho","k"),n.iter=10000)
# str(sam)
sam.coda <- coda.samples(mod,c("mu","rho","k"),n.iter=10000)
str(sam.coda)
str(sam)
plot(sam.coda,variables='rho')
plot.mcmc
?plot.mcmc
plot(sam.coda[,"rho"],density=FALSE)
hist(sam.coda[,"rho"])
sam.coda[,"rho"]
sam.coda[[1]][,"rho"]
hist(sam.coda[[1]][,"rho"])
hist(sam.coda[[1]][,"rho"],probability=TRUE)
hist(sam.coda[[1]][,"rho"],probability=TRUE)
?hist
hist(sam.coda[[1]][,"rho"],freq=TRUE)
hist(sam.coda[[1]][,"rho"],probability=TRUE)
?lines
hist(sam.coda[[1]][,"rho"],probability=TRUE)
rho <- seq(.5,1,length=100)
lines(rho,dunif(rho,0,.9),col=2)
hist(sam.coda[[1]][,"rho"],probability=TRUE)
rho <- seq(0,.9,length=100)
lines(rho,dunif(rho,0,.9),col=2)
hist(sam.coda[[1]][,"rho"],probability=TRUE)
rho <- seq(0,.9,length=50)
lines(rho,dunif(rho,0,.9),col=2)
plot(sam.coda[[1]][,"rho"],density=FALSE)
plot(sam.coda[,"rho"],density=FALSE)
plot(sam.coda[[1]][,"rho"],density=FALSE)
?plot.mcmc
traceplot(sam.coda[[1]][,"rho"])
?plot.mcmc
densplot(sam.coda[[1]][,"rho"],right=TRUE)
densplot(sam.coda[[1]][,"rho"],right=FALSE)
traceplot(sam.coda[[1]][,"rho"])
hist(sam.coda[[1]][,"rho"],probability=TRUE)
rho <- seq(0,.9,length=50)
lines(rho,dunif(rho,0,.9),col=2)
sam
str(sam)
sam$k[,,]
traceplot(sam$rho[,,])
sam.coda[,'mu']
sam.coda[,'k']
sam.coda[,'mu[1']
sam.coda
sam.coda[,'mu[1]']
plot(sam$rho)
plot(sam$rho,type='l')
traceplot(sam.coda[[1]][,"rho"])
hist(sam$rho,probability = TRUE)
hist(sam$rho[,,],probability = TRUE)
cols <- sprintf("mu[%d]",1:N)
N=w22-157+1
cols <- sprintf("mu[%d]",1:N)
sam.coda[[1]][,cols]
A
a
a=matrix(1:6,2,3)
a
rowM
rowMeans(a)
colMeans(a)
cols <- sprintf("mu[%d]",1:N)
mu_exp <- colMeans(sam.coda[[1]][,cols])
mu_exp
N
?window.mcmc.list
cols <- sprintf("mu[%d]",1:N)
mu.sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu.sam)
mu_exp
window(mu.sam,thin=2)
window(mu.sam,thin=50)
plot(1:N,window(mu_sam,thin=50))
cols <- sprintf("mu[%d]",1:N)
mu_sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu_sam)
plot(1:N,window(mu_sam,thin=50))
?apply
?sapply
cols <- sprintf("mu[%d]",1:N)
mu_sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu_sam)
mu_win <- window(mu_sam,thin=50)
for (i in 1:200) {
lines(1:N,m_win[i,])
}
cols <- sprintf("mu[%d]",1:N)
mu_sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu_sam)
mu_win <- window(mu_sam,thin=50)
for (i in 1:200) {
lines(1:N,mu_win[i,])
}
?plot
?pairs
cols <- sprintf("mu[%d]",1:N)
mu_sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu_sam)
mu_win <- window(mu_sam,thin=50)
plot()
?plt
cols <- sprintf("mu[%d]",1:N)
mu_sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu_sam)
mu_win <- window(mu_sam,thin=50)
weeks <- 1:N
plot(weeks,mu_exp)
for (i in 1:200) {
lines(weeks,mu_win[i,])
}
cols <- sprintf("mu[%d]",1:N)
mu_sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu_sam)
mu_win <- window(mu_sam,thin=50)
weeks <- 1:N
plot(weeks,mu_exp,col=" blue",type='l')
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
cols <- sprintf("mu[%d]",1:N)
mu_sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu_sam)
mu_win <- window(mu_sam,thin=50)
weeks <- 1:N
plot(weeks,mu_exp,col=" blue",type='l')
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
cols <- sprintf("mu[%d]",1:N)
mu_sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu_sam)
mu_win <- window(mu_sam,thin=50)
weeks <- 1:N
plot(weeks,mu_exp,col=" blue",type='l')
# for (i in 1:200) {
#   lines(weeks,mu_win[i,],col="grey")
# }
cols <- sprintf("mu[%d]",1:N)
mu_sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu_sam)
mu_win <- window(mu_sam,thin=50)
weeks <- 1:N
plot(weeks,mu_exp,col=" blue",type='l')
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
cols <- sprintf("mu[%d]",1:N)
mu_sam <- sam.coda[[1]][,cols]
mu_exp <- colMeans(mu_sam)
mu_win <- window(mu_sam,thin=50)
weeks <- 1:N
plot(weeks,ed2022_w,col=" black")
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
?plot.new
plot.new()
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
plot(weeks,ed2022_w,col=" black")
plot.new()
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
points(weeks,ed2022_w,col=" black")
?scatter
plot.new()
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
# points(weeks,ed2022_w,col=" black")
plot.new()
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
plot.new()
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
plot.window()
plot(weeks,ed2022_w,type="n")
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
points(weeks,ed2022_w,col=" black")
plot(weeks,ed2022_w-mu_exp)
plot(weeks,ed2022_w-mu_exp)
abline(0,0)
?abline
plot(weeks,ed2022_w-mu_exp)
abline(0,0,lty=2)
plot(weeks,ed2022_w,type="n")
for (i in 1:200) {
lines(weeks,mu_sam[i*50,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
points(weeks,ed2022_w,col=" black")
plot(weeks,ed2022_w-mu_exp)
abline(0,0,lty=2)
mu_win
mu_sam
window(mu_sam,end=11000,thin=50)
?window
?window.mcmc
window(mu_sam,start=1051,end=11000,thin=50)
window(mu_sam,start=1051,end=11050,thin=50)
window(mu_sam,thin=2)
plot(weeks,ed2022_w,type="n")
for (i in 1:200) {
lines(weeks,mu_sam[i*50,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
points(weeks,ed2022_w,col=" black")
plot(weeks,ed2022_w,type="n")
for (i in 1:200) {
lines(weeks,mu_win[i,],col="grey")
}
lines(weeks,mu_exp,col=" blue",type='l')
points(weeks,ed2022_w,col=" black")
1:4:2
1:2:4
?seq
